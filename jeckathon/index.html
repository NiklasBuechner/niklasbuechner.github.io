<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <title>JECKathon - Gemeinsam Karneval retten!</title>
    <link href="https://fonts.googleapis.com/css?family=Acme&amp;display=swap" rel="stylesheet">
    <style tyle="text/css">
        html {
            background:none transparent;
        }

        #game {
            display: grid;
            grid-template-rows: auto 100px;

            /* background-color: rgba(86, 179, 122, 0.28); */
            /* background-color: rgba(229, 82, 79, 0.1); */
            border: 10px solid #47368c;
            border-radius: 20px;
            width: 80%;
            max-width: 330px;
            height: 525px;
            margin-top: 200px;
            margin: auto;
            padding: 15px;
            text-align: center;
            font-family: sans-serif;
            color: #47368c;
        }

        h3 {
            font-size: 21px;
        }

        #game-content {
            margin: auto;
        }

        #game-content a {
            color: #47368c;
        }

        #game-buttons {
            grid-row: 2;
            align-self: stretch;
            margin-bottom: 20px;
            align-items: stretch;
        }

        #game-buttons a {
            background-color: #47368c;
            border-radius: 15px;
            color: white;
            padding: 10px;
        }
    </style>
    <script type="text/javascript">
        const rawData = `
        Startkarte: Grußworte mit Liveausschnitt ,,,,,,,,
Bezeichnung,Kategorie,Familienfreundlich?,Antwort (Text),Antwort (URL),Hilfsmittel aus der Box benötigt?,In Spiel mitaufnhemen?,In Box berücksichtigt?,Kommentar
Schminke dich mit geschlossenen Augen.,Aktion,Ja,,,Ggf.,Ja,Ja,
Zünde die Konfettikanone oder werft Konfetti über euch.,Aktion,Ja,,,Ja,Ja,Ja,Ggf. schmeiße das Konfetti über dich?
Hänge eine Girlande sichtbar auf.,Aktion,Ja,,,Ja,Ja,Ja,
Fühle dich wie beim Rosenmontagszug und schütte dir Kamelle über den Kopf.,Aktion,Ja,,,Ja,Ja,,
Glitzer dich mit Glitzer voll.,Aktion,Ja,,,Ja,Ja,Ja,
Setze dir eine rote Nase auf oder male sie auf. ,Aktion,Ja,,,Ja,Ja,Ja,
Blase die Luftschlangen auf.,Aktion,Ja,,,Ja,Ja,Ja,
"Schaut euch dieses Video an, um das Karnevalsfeeling zu bekommen. https://www.youtube.com/watch?v=gY8PdIvZENM",Aktion,Ja,,,Nein,Ja,,Link auf der Karte (QR-Code?)
Spiele dein Lieblingslied.,Aktion,Ja,,,Nein,Ja,,
Beschreibe dein Lieblingskostüm.,Aktion,Ja,,,Nein,Ja,,
Erzähle einen Witz,Aktion,Ja,,,Nein,Ja,,
Ein anderer muss einen Witz erzählen. Du wählst aus. ,Aktion,Ja,,,Nein,Ja,,
"Malt alle ein Lama und zeigt es der Gruppe. (Wer Lust hat, postet es auf Social Media #KarnevalLama) ",Aktion,Ja,,,Nein,Ja,,Könnten wir noch öfters reinnehmen --> Andere Tiere
Tanze auf einem Möbelstück deiner Wahl.,Aktion,Ja,,,Nein,Ja,,
Tanze deinen besten Siegestanz.,Aktion,Ja,,,Nein,Ja,,
Stimmt auf 3 ab: Wer ist von euch die größte Schwaadschnüss?,Aktion,Ja,,,Nein,Ja,,
Mache einen Purzelbaum.,Aktion,Ja,,,Nein,Ja,,
Jeder bastelt einen Karnevalsorden mit Dingen aus dem Haushalt. Zeit: 5 min. (Social Media #Jeckathon),Aktion,Ja,,,Nein,Ja,,
Singt gemeinsam den Refrain: En unserem Veedel ,Aktion,Ja,,,Nein,Ja,,
Erzähle eine peinliche Geschichte.,Aktion,Ja,,,Nein,Ja,,
Beschreibe dein Lieblings-Karnevalsessen.,Aktion,Ja,,,Nein,Ja,,
Was macht für dich Karneval aus?,Aktion,Ja,,,Nein,Ja,,
Erzähle deine lustigste Karnevalsgeschichte.,Aktion,Ja,,,Nein,Ja,,
Stimmt ab: Eher Team Kamelle oder Team Strüßjer?,Aktion,Ja,,,Nein,Ja,,
Ernennt jemanden der die nächsten 30 min Karnevalsmusik im Hintergrund laufen lässt.,Aktion,Ja,,,Nein,Ja,,
Macht ein Selfie und postet es. #Jeckathon,Aktion,Ja,,,Nein,Ja,,"FP: Ich persönlich bin nie Fan dieser 'posten'-Aktionskarte in Trinkspielen"
Schätzfrage: Wie viele Stufen hat der Kölner Dom?,Schätzen,Ja,533 Stufen,"https://www.koelntourismus.de/sehen-erleben/koelner-dom/turmbesteigung/#:~:text=Die%20Besucherplattform%20des%20K%C3%B6lner%20Doms,des%20S%C3%BCdturms%20f%C3%BChren%20533%20Treppenstufen.",Nein,Ja,,Mit Trinken im Anschluss?
Schätzfrage: In welchem Jahr war der erste Rosenmontagszug in Köln?,Schätzen,Ja,Im Jahr 1823 am 10. Februar. ,"https://www.koelntourismus.de/sehen-erleben/karneval/geschichte/#:~:text=1823%20wurde%20das%20%E2%80%9EFestordnende%20Komitee,%E2%80%9EThronbesteigung%20des%20Helden%20Carneval%E2%80%9C.",Nein,Ja,,Mit Trinken im Anschluss?
Jeder ohne Kostüm muss sich spontan verkleiden. Zeit: 5 min. ,Aktion,Ja,,,Nein,Ja,,
Stellt das kölsche Grundgesetz zusammen.,Wissen,Ja,"§ 1 - Et es wie et es<br />§ 2 - Et kütt wie et kütt<br />§ 3 - Et hätt noch immer jot jejange<br /><br />§ 4 - Wat fott es es fott<br />§ 5 - Nix bliev wie et wor<br />§ 6 - Kenne mer nit, bruche mer nit, fott domet<br />§ 7 - Wat wellste maache<br />§ 8 - Mach et jot ävver nit ze off<br />§ 9 - Wat soll dä Quatsch?<br />§ 10 - Drinkste ene met?<br />§ 11 - Do laachste dech kapott",https://www.koeln.de/koeln/das-koelsche-grundgesetz-die-11-regeln-der-domstadt_1121331.html,Nein,Ja,,
Beschreibe das Essen “Himmel un Ääd”,Wissen,Ja,Stampfkartoffeln mit Blutwurst und Apfel,https://www.koeln.de/koeln/essen_und_trinken/rezepte/himmel-und-erde-himmel-un-aed_884070.html,Nein,Ja,,
Beschreibt das Gericht Halve Hahn.,Wissen,Ja,"Zwei dicke Scheiben mittelalter Gouda, ein halbes Roggenbrötchen (Röggelchen) mit Butter, saurer Gurke und Senf.",https://www.frueh.de/frueh-erleben/typisch-koeln/halve-hahn/,Nein,Ja,,
Kennt ihr die Leitsätze des Karnevals? Wie viele gibt es? ,Wissen,Ja,Es gibt 11 Leitsätze.,https://koelnerkarneval.de/akademie/,Nein,Ja,,
Beschreibt das Verhalten eines Köbes. ,Wissen,Ja,Mitunter etwas derbe und forsche Art.,https://www.frueh.de/frueh-erleben/typisch-koeln/koebes/,Nein,Ja,,
Welcher Turm vom Kölner Dom ist höher? ,Wissen,Ja,"Mit 157,22 m ist der Südturm 0,4 m höher als der Nordturm.",https://www.koelner-dom.de/erleben/der-dom-in-zahlen,,Ja,,
Was ist der Katzenbuckel in Köln? ,Wissen,Ja,"Die kleine Fußgängerbrücke, die den Mülheimer Hafen mit einer schmalen Rheinhalbinsel verbindet.",https://www.koeln.de/koeln/111_koelner_orte_kleine_bruecke_mit_grossem_panorama_298595.html,,Ja,,
Wie hoch ist der Mont Troodelöh?  ,Wissen,Ja,"Er ist 118,04 Meter hoch und  ist die höchste Erhebung der Stadt Köln.",http://www.monte-troodeloeh.de/,,Ja,,
Was ist der Pletchbach? ,Wissen,Ja,Der Pletschbach ist ein linkes Nebengewässer des Rheins zwischen Dormagen und Köln-Worringen.,,,Ja,,
Wie viele Veedel hat Köln? ,Wissen,Ja,86 Veedel,,,Ja,,
Hole dir ein Bier aus dem Kühlschrank.,Trinken,Nein,,,Ja,Ja,Ja,Ggf. öfters
Was ist dein Lieblingsgetränk an Karneval?,Aktion,Nein,,,Nein,Ja,,
Lies den Text eines Karnevallieds vor. ,Aktion,Nein,,,Nein,Ja,,
Mische dir ein Getränk mit den Zutaten aus deiner Küche.,Aktion,Nein,,,Nein,Ja,,
"Wie machst du im Brauhaus bemerkbar, dass du kein Kölsch mehr haben möchtest?",Wissen,Nein,Den Bierdeckel auf das Kölschglas legen.,https://www.frueh.de/frueh-erleben/typisch-koeln/deckel-aufm-glas/,Nein,Ja,,
Versucht so viele Kölschsorten aufzuzählen wie ihr kennt. ,Wissen,Nein,"Die bekanntesten 17 Kölschsorten sind folgende: Früh Kölsch, Bischoff Kölsch, Dom Kölsch, Gaffel Kölsch,Ganser Kölsch, Gilden Kölsch, Hellers Kölsch, Küppers Kölsch, Mühlen Kölsch, Päffgen Kölsch, Peters Kölsch, Reissdorf Kölsch, Richmodis Kölsch, Sester Kölsch, Sion Kölsch, Sünner Kölsch, Zunft Kölsch.<br /><br />Wie viele Kölschsorten es tatsächlich gibt, vermag kaum jemand zu sagen, da immer wieder neue kleinere Kölschsorten entstehen und auch wieder unbemerkt vom Markt verschwinden. Es ist von ca. 25 Kölschsorten die Rede. ","https://www.stadtgeschichten-stadtfuehrungen.koeln/component/content/article/181-koelsch-ist-koelsch-von-neuen-und-alten-koelschsorten.html#:~:text=Die%20drei%20gr%C3%B6%C3%9Ften%20Sorten%20sind,P%C3%A4ffgen%20K%C3%B6lsch%2C%20das%20K%C3%B6nigs%20K%C3%B6lsch!",Nein,Ja,,
Wie kalt ist das perfekte Kölsch?,Wissen,Nein,Viele Brauereien empfehlen ein Trinktemperatur zwischen sechs und acht Grad.,,Nein,Ja,,
Wie viel Liter Bier sind in einem Kranz Kölsch? ,Wissen,Nein,"11x0,2L = 2,2L",,,Ja,,
Was hat Konrad von Hochstaden in Köln im Mund? ,Wissen,Nein,Schaut es euch selber an. Google: Konrad von Hochstaden Köln,https://www.morgenpost.de/vermischtes/article216805559/Obszoene-Stein-Figur-an-Koelner-Rathaus-sorgt-fuer-Raetselraten.html,,Ja,,
Wie viel Umsatz machen Gastronomie und Verzehr in einer Session? ,Wissen,Nein,257.000.000 Euro,,,Ja,,
Was ist ein Fisternöllche? ,Wissen,Nein,Ein Fisternöllchen ist eine heimliche Liebelei.,,,Ja,,
Wie wird Karneval noch genannt? ,Wissen,Ja,Die 5. Jahreszeit,,,Ja,,
Was ist der Jeisterzoch en Kölle?,Wissen,Ja,"Ein alternativer Karnevalsumzug und politische Demonstration zugleich. 'Der Zug soll sowohl karnevalistisch als auch politisch sein:<br />Jede und jeder kann diesen Zug als Demonstration für oder gegen das, was nach seinem/ ihrem Erachten gefördert/ bekämpft werden muss benutzen.'",https://www.geisterzug.de/geisterzug/zugregeln/,,Ja,,
Wie viele Brücken hat Köln? ,Wissen,Ja,7 Brücken. ,,,Ja,,
Was verschließen verliebte Paare in Köln? ,Wissen,Ja,Sie hängen ein Vorhängeschloss an die Kölner Hohenzollernbrücke und werfen den Schlüssel in den Rhein.,,,Ja,,
"Was bedeutet eigentlich 'Alaaf'?",Wissen,Ja,"Das Wort 'Alaaf' stammt wohl aus dem Kölschen 'all af', was soviel heißt wie 'über alles'. Wenn Sie also 'Kölle alaaf' rufen, bedeutet das so viel wie 'Köln über alles'.",https://www.radiokoeln.de/artikel/11-fakten-testet-euer-jeckes-wissen-80072.html,,Ja,,
Schätzfrage: Wie viel Kamelle und Strüßjer werden beim Rosenmontagszug geworfen? ,Schätzen,Ja,"Jedes Jahr werden während des Rosenmontagszugs rund 300 Tonnen Süßigkeiten und Strüßjer in die Menge geworfen. Genau bedeutet das rund 700.000 Tafeln Schokolade, 220.000 Schachteln Pralinen und 300.000 Strüßjer. ",https://www.ksta.de/freizeit/karneval-2020-die-zehn-wichtigsten-fakten-zum-ros  ,,Ja,,
Wie lang ist die Zugstrecke des Rosenmontagszuges? ,Wissen,Ja,Etwa 7km durch die Kölner Innenstadt. ,,,Ja,,
Spielt eine runde. Ich packe in meinen Koffer....,Aktion,Ja,,,,Ja,,
Was ist längst fertig und wird doch täglich gemacht?,Scherzfrage,Ja,Das Bett,,,Ja,,
Welcher Ring ist nicht rund?,Scherzfrage,Ja,Der Hering,,,Ja,,
Womit fängt der Tag an und hört die Nacht auf?,Scherzfrage,Ja,"Mit 'T'",,,Ja,,
Wo führen die Flüsse kein Wasser?,Scherzfrage,Ja,Auf der Landkarte,,,Ja,,
"Ein angebrannt Gericht behaget nicht. Doch eins ist mir bekannt, das schmeckt erst angebrannt.",Rätsel,Ja,Tabak,,,Ja,,
Versucht mit geschlossenen Augen ein Schwein zu zeichnen und zeigt es der Gruppe,Aktion,Ja,,,,Ja,,
Wie lautet das Kölsche Wort für Schnaps?,Wissen,Ja,Schabbau,,,Ja,,
Wie viele Bahnsteige hat der Kölner Hauptbahnhof?,Wissen,Ja,11,,,Ja,,
"Welche Hausnummer hat der Kölner Dom? 1a, 4, 11, 23",Wissen,Ja,4,,,Ja,,
Was darf im Karnevalsgebäck Muuzemändelcher nicht fehlen?,Wissen,Ja,Mandeln,,,Ja,,
Mache eine lustige Grismase. ,Aktion,Ja,,,,Ja,,
"Was ruft man in anderen Gemeinden ansattt 'Kölle Alaaf'?",Gemeinschaft,Ja,,,,Ja,,
`;

        const cards = [];
        let status = 'not-playing';
        let cardIndex = -1;
        let currentCards = [];

        const parseRawData = () => {
            const lines = rawData.split('\n');
            let tableStartedYet = false;

            for (line of lines) {
                if (tableStartedYet === false) {
                    if (line.startsWith('Bezeichnung')) {
                        tableStartedYet = true;
                    }

                    continue;
                }

                const fields = [];
                let inQuotes = false;
                let field = '';
                for (character of line) {
                    switch (character) {
                        case '"':
                            inQuotes = !inQuotes;
                            break;
                        case ',':
                            if (inQuotes) {
                                field += character;
                            } else {
                                fields.push(field);
                                field = '';
                            }
                            break;
                        default:
                            field += character;
                            break;
                    }
                }

                if (fields.length < 3) {
                    continue;
                }

                const card = {
                    type: fields[1],
                    question: fields[0],
                    isFamilyFriendly: fields[2].toLocaleLowerCase() === 'ja',
                };

                if (fields[3].trim().length > 0) {
                    card.answer = fields[3];
                }

                if (fields[4].trim().length > 0) {
                    card.answerUrl = fields[4];
                }

                cards.push(card);
            }
        };

        const shuffle = (array) => {
            let currentIndex = array.length;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                const randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                const temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
        };

        window.addEventListener('load', () => {
            parseRawData();
            updateGame();
        });

        const updateGame = () => {
            if (status === 'not-playing') {
                showNotPlayingScreen();
            } else {
                showNextCard();
            }
        };

        const updateHtmlElements = (content, button) => {
            document.getElementById('game-content').innerHTML = content;
            document.getElementById('game-buttons').innerHTML = `<a href="#" onclick="javascript:${button.click}();">${button.label}</a>`;
        };

        const showNotPlayingScreen = () => {
            updateHtmlElements(
                `
                <h3>Bist du bereit? Spiele mit uns!</h3>
                <input id="family-friendly" name="family-friendly" type="checkbox" /><label for="family-friendly"> Familienfreundliche Version</label>
                `,
                { click: 'startGame', label: 'Let\'s go!'},
            );
        };

        const startGame = () => {
            status = 'playing';

            shuffle(cards)
            if (document.getElementById('family-friendly') && !document.getElementById('family-friendly').checked) {
                currentCards = cards;
            } else {
                currentCards = cards.filter(card => card.isFamilyFriendly);
            }

            updateGame();
        };

        const showNextCard = () => {
            cardIndex += 1;
            if (cardIndex === currentCards.length) {
                cardIndex = 0;
            }

            const card = currentCards[cardIndex];
            const nextCardButton = {
                click: 'nextCard',
                label: 'Nächste Karte',
            };
            const showAnswerButton = {
                click: 'showAnswer',
                label: 'Antwort zeigen',
            };

            updateHtmlElements(
                `
                <h3>${card.type}</h3>
                <p>${card.question}</p>
                `,
                !!card.answer ? showAnswerButton : nextCardButton,
            );
        };

        const nextCard = updateGame;

        const showAnswer = () => {
            const card = currentCards[cardIndex];
            const answerUrl = card.answerUrl;
            let more = '';

            if (answerUrl) {
                const matchingUrl = answerUrl.match(/(https?:\/\/[a-zA-Z-\.]+\/?)/);
                more = `<p>Weitere Informationen unter <br /><a href="${card.answerUrl}" target="_blank">${matchingUrl[0]}</a></p>`
            }

            updateHtmlElements(
                `
                <h3>${card.type}</h3>
                <p>${card.question}</p>
                <p><i>${card.answer}</i></p>
                ${more}
                `,
                {
                    click: 'nextCard',
                    label: 'Nächste Karte',
                },
            );
        };
    </script>
</head>

<body>
    <div id="game">
        <div id="game-content">
            <h3>Loading</h3>
        </div>
        <div id="game-buttons">
        </div>
    </div>
</body>

</html>
